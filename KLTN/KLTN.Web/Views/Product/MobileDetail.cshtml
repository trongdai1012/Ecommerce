@model KLTN.DataModels.Models.Products.MobileViewModel
@{
    ViewData["Title"] = "MobileDetail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /***
     *  Simple Pure CSS Star Rating Widget Bootstrap 4
     *
     *  www.TheMastercut.co
     *
     ***/

    /* Styling h1 and links
    ––––––––––––––––––––––––––––––––– */
    h1[alt="Simple"] {
        color: white;
    }

    a[href], a[href]:hover {
        color: grey;
        font-size: 0.5em;
        text-decoration: none
    }

    .starrating > input {
        display: none;
    }
    /* Remove radio buttons */

    .starrating > label:before {
        content: "\f005"; /* Star */
        margin: 2px;
        font-size: 2em;
        font-family: FontAwesome;
        display: inline-block;
    }

    .starrating > label {
        color: #d8e4e3; /* Start color when not clicked */
    }

    .starrating > input:checked ~ label {
        color: #ffca08;
    }
    /* Set yellow color when star checked */

    .starrating > input:hover ~ label {
        color: #ffca08;
    }
    /* Set yellow color when star hover */


</style>

<!--================Home Banner Area =================-->
<section class="banner_area" style="margin-top:30px">
    <div class="banner_inner d-flex align-items-center">
        <div class="container">
            <div class="banner_content d-md-flex justify-content-between align-items-center">
                <div class="mb-3 mb-md-0">
                    <h2>Big Const Ecommerce</h2>
                    <p>Luôn sẵn sàng phục vụ</p>
                </div>
                <div class="page_link">
                    <a href="/">Trang chủ</a>
                    <a asp-action="Mobile" asp-controller="Product">Điện thoại</a>
                    <a>Chi tiết sản phẩm</a>
                </div>
            </div>
        </div>
    </div>
</section>
<!--================End Home Banner Area =================-->
<!--================Single Product Area =================-->
<div class="product_image_area">
    <div class="container">
        <div class="row s_product_inner">
            <div class="col-lg-6" style="margin: auto">
                <div class="s_product_img">
                    <div id="carouselExampleIndicators"
                         class="carousel slide"
                         data-ride="carousel">
                        <ol class="carousel-indicators">
                            <li data-target="#carouselExampleIndicators"
                                data-slide-to="0"
                                class="active">
                                <img src="~/DataImage/@Model.Images[0].Url"
                                     alt="" width="60" height="60" />
                            </li>
                            <li data-target="#carouselExampleIndicators"
                                data-slide-to="1">
                                <img src="~/DataImage/@Model.Images[0].Url"
                                     alt="" width="60" height="60" />
                            </li>
                            <li data-target="#carouselExampleIndicators"
                                data-slide-to="2">
                                <img src="~/DataImage/@Model.Images[0].Url"
                                     alt="" width="60" height="60" />
                            </li>
                        </ol>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img class="d-block w-100"
                                     src="~/DataImage/@Model.Images[0].Url"
                                     alt="First slide"
                                     style="height: 100%;width: 100% " />
                            </div>
                            <div class="carousel-item">
                                <img class="d-block w-100"
                                     src="~/DataImage/@Model.Images[0].Url"
                                     alt="Second slide"
                                     height: 100%;width: 100% />
                            </div>
                            <div class="carousel-item">
                                <img class="d-block w-100"
                                     src="~/DataImage/@Model.Images[0].Url"
                                     alt="Third slide"
                                     height: 100%;width: 100% />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5 offset-lg-1" style="height:540px;width:475px">
                <div class="s_product_text" style="height:439px;width:460px;">
                    <h3>@Model.Name</h3>
                    <h2>@Model.CurrentPrice</h2>
                    <ul class="list">
                        <li>
                            <a class="active">
                                <span>Thể loại</span> : Điện thoại
                            </a>
                        </li>
                        <li>
                            <a> <span>Kho</span> : @Model.Quantity sản phẩm</a>
                        </li>
                    </ul>
                    <div style="height:210px;width:439px">
                        <p>
                            Miêu tả: @Model.Description
                        </p>
                    </div>
                    <div class="product_count">
                        <label for="qty">Số lượng:</label>
                        <input type="number"
                               name="qty"
                               id="sst"
                               maxlength="12"
                               value="1"
                               title="Quantity:"
                               class="input-text qty"
                               onkeyup="myFunction()"
                               min="1"
                               max="@Model.Quantity"
                               oninput="check(this)" />
                        <button onclick="UpInput()"
                                class="increase items-count"
                                type="button">
                            <i class="lnr lnr-chevron-up"></i>
                        </button>
                        <button onclick="DownInput()"
                                class="reduced items-count"
                                type="button">
                            <i class="lnr lnr-chevron-down"></i>
                        </button>
                    </div>
                    <div class="card_area">
                        <span id="cart-submit"></span>
                        <a class="icon_btn" href="#">
                            <i class="lnr lnr lnr-diamond"></i>
                        </a>
                        <a class="icon_btn" href="#">
                            <i class="lnr lnr lnr-heart"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--================End Single Product Area =================-->
<!--================Product Description Area =================-->
<section class="product_description_area">
    <div class="container">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link"
                   id="home-tab"
                   data-toggle="tab"
                   href="#home"
                   role="tab"
                   aria-controls="home"
                   aria-selected="true">Miêu tả</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                   id="profile-tab"
                   data-toggle="tab"
                   href="#profile"
                   role="tab"
                   aria-controls="profile"
                   aria-selected="false">Thông tin chi tiết</a>
            </li>
            <li class="nav-item">
                <a class="nav-link"
                   id="contact-tab"
                   data-toggle="tab"
                   href="#contact"
                   role="tab"
                   aria-controls="contact"
                   aria-selected="false">Bình luận</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active"
                   id="review-tab"
                   data-toggle="tab"
                   href="#review"
                   role="tab"
                   aria-controls="review"
                   aria-selected="false">Đánh giá</a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">

        </div>
    </div>
</section>
<!--================End Product Description Area =================-->
@section scripts{
    <script>
        var id = @Model.Id;
        var quantity = document.getElementById("sst").value;
        if (quantity < 1) quantity = 1;
        var html = '<a class="main_btn" onMouseOver="this.style.color=\'#71cd14\'" onMouseOut="this.style.color=\'#fff\'" style="font-size:12px;color:#fff" href="/Cart/Buy/' + (this).id + '?quantity=' + quantity + '">Thêm vào giỏ</a>';
        document.getElementById('cart-submit').innerHTML = html;
        function myFunction() {
            var quantity = document.getElementById("sst").value;
            if (quantity < 1) quantity = 1;
            var html = '<a class="main_btn" onMouseOver="this.style.color=\'#71cd14\'" onMouseOut="this.style.color=\'#fff\'" style="font-size:12px;color:#fff" href="/Cart/Buy/' + (this).id + '?quantity=' + quantity + '">Thêm vào giỏ</a>';
            document.getElementById('cart-submit').innerHTML = html;
        }
        function UpInput() {
            var result = document.getElementById('sst');
            var sst = result.value;
            if (!isNaN(sst)) result.value++;
            var quantity = document.getElementById("sst").value;
            if (quantity < 1) quantity = 1;
            var html = '<a class="main_btn" onMouseOver="this.style.color=\'#71cd14\'" onMouseOut="this.style.color=\'#fff\'" style="font-size:12px;color:#fff" href="/Cart/Buy/' + (this).id + '?quantity=' + quantity + '">Thêm vào giỏ</a>';
            document.getElementById('cart-submit').innerHTML = html;
        }
        function DownInput() {
            var result = document.getElementById('sst');
            var sst = result.value;
            if (!isNaN(sst)) result.value--;
            var quantity = document.getElementById("sst").value;
            if (quantity < 1) quantity = 1;
            var html = '<a class="main_btn" onMouseOver="this.style.color=\'#71cd14\'" onMouseOut="this.style.color=\'#fff\'" style="font-size:12px;color:#fff" href="/Cart/Buy/' + (this).id + '?quantity=' + quantity + '">Thêm vào giỏ</a>';
            document.getElementById('cart-submit').innerHTML = html;
        }
    </script>
    <script>
        var valueStar = 0;
        var cmt;
        function GetValueStar(id) {
            valueStar = document.getElementById(id).value;
        }

        function Rating(productId, comment, rate) {
            $.ajax({
                url: '/Product/Rating',
                data: { productId: productId, comment: comment, rate: rate },
                type: 'POST',
                dataType: 'json',
                success: function (response) {
                    if(response.status == 3) {
                        alert('Bạn đã bị khoá chức năng đánh giá sản phẩm này!');
                    }
                    else if (response.status==1) {
                        GetFeedback(@Model.Id);
                        alert('Đánh giá thành công!');
                    } else if (response.status == 0) {
                        alert('Vui lòng mua sản phẩm để trải nghiệm trước khi đánh giá!');
                    }
                    else if (response.status == 2) {
                        alert('Bạn đã bị khoá chức năng đánh giá sản phẩm này!');
                    }
                    else {
                        alert('Đánh giá thất bại. Vui lòng liên hệ quản trị viên để xử lý.');
                    }
                }
            })
        };

        $(document).on('click', '#rating-btn', function () {
            cmt = document.getElementById('comment').value;
            Rating(@Model.Id, cmt, valueStar);
            valueStar = 0;
        });

        $(function () {
            GetFeedback(@Model.Id);
        });
        function GetFeedback(id) {
            $.ajax({
                url: '/Product/FeedbackProduct',
                type: 'POST',
                cache: false,
                async: true,
                dataType: "html",
                data: { id: id }
            }).done(function (result) {
                $('#myTabContent').html(result);
                });
        }
    </script>
}

